# 3. Key Encapsulation Mechanism (KEM)

A **KEM** is a cryptographic primitive to securely deliver a **session key** to a receiver using **public-key cryptography**.

---

## 1️⃣ Why KEM Exists

- Public-key encryption of large data is inefficient.
- KEM exchanges only a small **session key** securely.
- Once shared, that session key is used with **fast symmetric encryption**.

---

## 2️⃣ Three Core Algorithms in KEM

### (A) Key Generation — `KeyGen()`
- Run by **Receiver**.
- Output: `(pk, sk)` public and private key pair.

### (B) Encapsulation — `Encapsulate(pk)`
- Run by **Sender** using Receiver’s `pk`.
- Output: `(c, K)`:
  - `c` = ciphertext encapsulation of key.
  - `K` = session key.

### (C) Decapsulation — `Decapsulate(c, sk)`
- Run by **Receiver**.
- Input: `c` and `sk`.
- Output: session key `K`.

---

## 3️⃣ Protocol Flow of KEM

1. **Receiver → KeyGen()** → `(pk, sk)`.
2. **Receiver → publishes pk**.
3. **Sender → Encapsulate(pk)** → `(c, K)`.
4. **Sender → sends c**.
5. **Receiver → Decapsulate(c, sk)** → `K`.
6. **Both now share K** (used for symmetric encryption).

---

## 4️⃣ Security Properties of KEM

- **Confidentiality:** Only Receiver can recover `K`.
- **Indistinguishability:** `K` appears random to outsiders.
- **Robustness:** Even if some values leak, `sk` stays secure.
- **Efficiency:** Symmetric encryption with `K` is much faster than encrypting full data with public-key cryptography.

---

## 5️⃣ Applications of KEM

- **TLS 1.3 / HTTPS** (post-quantum handshakes).
- **VPNs / SSH** secure channel key establishment.
- **Hybrid encryption schemes** (Public Key = KEM, Symmetric Key = DEM).

---

## 6️⃣  Text Tree of KEM

<img width="397" height="481" alt="image" src="https://github.com/user-attachments/assets/30b74e6b-88d9-4464-a5a2-e0c126b46681" />


## 7️⃣ Visual Diagram
![WhatsApp Image 2025-09-13 at 21 59 53_4f6f0c70](https://github.com/user-attachments/assets/d61278c1-a5ea-4434-81ef-7f20922d2391)

---
## KEX VS KEM

| Feature                      | **KEX (Key Exchange)**                                                                                      | **KEM (Key Encapsulation Mechanism)**                                                                                     |
| ---------------------------- | ----------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| **Goal**                     | Two parties *jointly derive* a shared secret (session key) without transmitting it directly.                | Sender *creates or encrypts* a random session key and securely delivers it to Receiver.                                   |
| **Main Idea**                | Each party contributes secret material → both compute same key locally.                                     | Receiver generates public/private key pair → Sender uses public key to encapsulate a session key → Receiver decapsulates. |
| **Key Creation**             | Key is **computed** by both sides from their private key + other party’s public key. (e.g., Diffie–Hellman) | Key is **generated by Sender** and then **encapsulated** to Receiver using Receiver’s public key.                         |
| **Algorithms Used**          | Diffie–Hellman (DH/DHE), Elliptic Curve DH (ECDH/ECDHE), Hybrid (ECDHE + Kyber).                            | RSA-KEM, Kyber, NewHope, FrodoKEM, Hybrid KEM.                                                                            |
| **Public/Private Keys**      | Both sides generate public/private keys for exchange.                                                       | Only the Receiver generates a public/private key pair; Sender just uses public key to encapsulate.                        |
| **Session Key Transmission** | No key is sent directly — only public parameters exchanged.                                                 | A ciphertext (encapsulation) is sent containing the session key.                                                          |
| **Security Basis**           | Hardness of **Discrete Logarithm** (or Elliptic Curve DL) or PQ equivalents.                                | Hardness of **lattice/RSA** or other PQ assumptions depending on KEM.                                                     |
| **Speed**                    | Usually faster in classic settings; simple math but needs both sides to compute.                            | Encapsulation/decapsulation is one-shot; can be more efficient for bulk data after key exchange.                          |
| **Use in Protocols**         | TLS 1.2/1.3 (ECDHE), SSH, IPsec.                                                                            | Post-quantum TLS (Kyber), RSA-KEM in hybrid systems.                                                                      |
| **When Preferred**           | When you want **mutual contribution** and **forward secrecy**.                                              | When you want **one-way key delivery** and **simple session key establishment**.                                          |

---
